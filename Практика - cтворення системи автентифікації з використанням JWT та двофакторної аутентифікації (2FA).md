#### Опис

Ви маєте реалізувати просту систему аутентифікації користувачів, яка використовує JWT (JSON Web Token) для авторизації запитів. Система також повинна підтримувати двофакторну аутентифікацію через OTP (одноразовий пароль), що надсилається на електронну пошту.

#### Вимоги

1. **Реєстрація користувача**:
    
    - Користувач створює обліковий запис, вказуючи ім’я користувача, електронну пошту та пароль.
    - Пароль повинен зберігатися у захищеному вигляді (хешований).
2. **Аутентифікація (Вхід користувача)**:
    
    - Користувач вводить свою електронну пошту та пароль для входу.
    - Якщо аутентифікація успішна, сервер генерує JWT і відправляє одноразовий код (OTP) на електронну пошту користувача для двофакторної перевірки.
3. **Двофакторна перевірка**:
    - Користувач вводить OTP, який він отримав на свою електронну пошту.
    - Якщо код правильний і не прострочений, користувач отримує повний доступ до свого профілю.
    - OTP дійсний лише протягом 5 хвилин.
4. **Доступ до захищеного ресурсу**:
    
    - Після успішної двофакторної перевірки користувач може отримати доступ до захищених маршрутів API, використовуючи свій JWT у заголовку запиту (`Authorization: Bearer <token>`).
5. **Refresh Token**:
    
    - Реалізуйте механізм для оновлення токену доступу. Використовуйте refresh token, щоб надати новий access token без необхідності повторної аутентифікації.

#### Технічні вимоги

- **Backend**: Node.js
- **База даних**: Redis
- **JWT**: Використовуйте пакет `jsonwebtoken` для генерації та перевірки токенів
- **Хешування паролів**: Використовуйте `bcrypt` для хешування паролів
- **OTP**: Згенеруйте OTP, використовуючи, наприклад, пакет `otp-generator`, та надішліть його через Nodemailer
- **Термін дії токенів**: Access token — 15 хвилин, Refresh token — 1 тиждень

#### Порядок виконання

1. **Налаштуйте сервер**:
    
    - Створіть проект Express.js з базовою структурою.
    - Підключіть MongoDB та налаштуйте моделі для зберігання користувачів (ім'я, електронна пошта, хешований пароль, OTP).
2. **Реалізуйте реєстрацію користувача**:
    
    - Створіть маршрут для реєстрації, де користувачі можуть зареєструватися, вказуючи електронну пошту та пароль.
    - Хешуйте пароль перед збереженням у базу даних.
3. **Реалізуйте вхід та генерацію OTP**:
    
    - Створіть маршрут для аутентифікації користувача.
    - Якщо вхід успішний, генеруйте JWT та OTP, який надсилається на електронну пошту користувача.
4. **Реалізуйте перевірку OTP**:
    
    - Створіть маршрут для перевірки OTP. Перевіряйте, чи введений користувачем код співпадає з OTP, надісланим на електронну пошту, та чи він ще не прострочений.
5. **Реалізуйте захищений ресурс**:
    
    - Створіть захищений маршрут, доступ до якого можливий лише після успішної двофакторної перевірки.
    - Додайте middleware, який перевіряє JWT у заголовку запиту.
6. **Реалізуйте refresh token**:
    
    - Створіть механізм для оновлення access token, використовуючи refresh token.

#### Додаткове завдання

1. **Створіть сторінку реєстрації та входу** (якщо є бажання) на React або іншим фронтенд-фреймворком.
2. **Додайте обмеження на кількість запитів для OTP**, щоб уникнути зловживання.

#### Результат

Завдання допоможе вам освоїти:

- Основи роботи з JWT.
- Реалізацію двофакторної аутентифікації через OTP.
- Створення захищених маршрутів у Node.js.
- Механізм роботи з токенами доступу та оновлення.